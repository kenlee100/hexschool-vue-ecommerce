import{_ as S,a as C,m as T,r as i,o as r,c,e as u,b as e,h as O,i as a,F as b,g as I,t as s,n as x,w as P}from"./index-8dc51b0a.js";import{P as L}from"./PageHeader-6a365377.js";import{C as V}from"./CartStep-39c67ab8.js";import{a as n}from"./common-0df46e94.js";import{c as g}from"./cartStore-b76d7477.js";import{t as h}from"./toast-7bff71d1.js";const E="/hexschool-vue-ecommerce/assets/page_checkout-59354980.jpg",{VITE_URL:y,VITE_PATH:m}={VITE_PATH:"ken100",VITE_URL:"https://vue3-course-api.hexschool.io/v2",BASE_URL:"/hexschool-vue-ecommerce",MODE:"production",DEV:!1,PROD:!0,SSR:!1},M={data(){return{order:{products:[],user:{}},finalTotal:{},pageImage:E}},components:{PageHeader:L,CartStep:V},methods:{...C(g,["checkStep","couponPercent","loadCouponCode"]),async getOrder(){try{await this.$http.get(`${y}/api/${m}/order/${this.orderId}`).then(o=>{n().isLoading=!1;const{order:d}=o.data;this.order=d,this.finalTotal=Object.entries(this.order.products).reduce((p,_)=>p+_[1].total,0)})}catch(o){n().isLoading=!1,h.fire({icon:"error",title:`${o.response.data.message}`})}},async payOrder(){n().isProcessing=!0;try{await this.$http.post(`${y}/api/${m}/pay/${this.orderId}`).then(()=>{this.getOrder(),n().isProcessing=!1,h.fire({icon:"success",title:"付款完成"}),setTimeout(()=>{this.$router.push("/")},3e3)})}catch(o){n().isLoading=!1,h.fire({icon:"error",title:`${o.response.data.message}`})}}},computed:{...T(g,["currentStep","couponState"])},mounted(){n().isLoading=!0,this.checkStep(3),this.orderId=this.$route.params.orderId,this.getOrder(),this.loadCouponCode()}},B={class:"container"},H={class:"flex flex-col lg:flex-row space-y-8 lg:space-y-0 lg:space-x-8"},R={class:"lg:w-[66.666%]"},A={class:"flex flex-col space-y-4"},D={class:"overflow-hidden hidden md:flex flex-shrink-0 w-[140px] [&:not(:last-child)]:mr-4"},N={class:"overflow-hidden"},U=["src","alt"],F={class:"flex flex-col md:flex-row md:items-center md:justify-between w-full space-y-4 md:space-y-0"},$={class:"w-full md:w-auto md:flex-1 md:pr-4"},q={class:"font-bold ch-heading-3 line-clamp-2"},z={class:"flex flex-1 items-center md:justify-end md:flex-shrink-0"},G={class:"ml-auto en-caption-01 whitespace-nowrap"},J={class:"flex items-center justify-end flex-shrink-0 min-w-[120px]"},K={class:"flex flex-col items-end min-w-[50px] space-y-1"},Q={key:0,class:"en-caption-02 line-through text-right"},W={class:"en-body text-right text-secondary-secondary-200"},X={class:"flex items-center justify-end"},Y={key:0,class:"flex space-x-4 ch-heading-4 font-bold text-netural-netural-300"},Z=e("span",null,"共",-1),ee={class:"en-body text-secondary-secondary-200"},te=e("span",null,"件商品",-1),se={class:"space-y-8"},oe={class:"flex flex-col p-4 md:p-6 space-y-4 bg-netural-netural-200"},le={class:"flex flex-col space-y-2 pb-3"},re={class:"flex justify-between"},ce=e("p",{class:"font-bold ch-body"},"小計：",-1),ae={key:0,class:"flex justify-between"},ne=e("p",{class:"font-bold ch-body"},"折扣後：",-1),de={class:"flex-shrink-0 en-caption-01"},ie={key:1,class:"flex justify-between"},he=e("p",{class:"font-bold ch-body"},"優惠券：",-1),pe={class:"font-bold ch-body text-netural-netural-300"},_e={class:"flex justify-between"},fe=e("p",{class:"font-bold ch-heading-4"},"總計:",-1),ue={class:"flex-shrink-0 en-body text-secondary-secondary-200"},be={class:"flex flex-col lg:w-[33.333%]"},xe={class:"overflow-hidden flex flex-col items-center p-4 md:p-6 bg-netural-netural-200"},ge={class:"flex flex-col w-full space-y-4"},ye=e("h3",{class:"ch-heading-2 font-bold"},"訂單明細",-1),me={class:"flex flex-col justify-between items-start flex-wrap [&:not(:last-child)]:pb-4 [&:not(:last-child)]:border-b border-netural-netural-300 [&:not(:last-child)]:border-opacity-30 break-all"},ke=e("p",{class:"font-bold ch-heading-4"},"訂單編號：",-1),we={class:"flex-1 ch-heading-4 break-all lg:text-right"},ve={class:"flex flex-col justify-between items-start flex-wrap [&:not(:last-child)]:pb-4 [&:not(:last-child)]:border-b border-netural-netural-300"},je=e("p",{class:"font-bold ch-heading-4"},"訂單建立時間：",-1),Se={class:"flex-1 ch-heading-4 break-all lg:text-right"},Ce={class:"flex flex-col justify-between items-start flex-wrap [&:not(:last-child)]:pb-4 [&:not(:last-child)]:border-b border-netural-netural-300 [&:not(:last-child)]:border-opacity-30 break-all"},Te=e("p",{class:"font-bold ch-heading-4"},"信箱：",-1),Oe={class:"flex-1 ch-heading-4 break-all lg:text-right"},Ie={class:"flex flex-col justify-between items-start flex-wrap [&:not(:last-child)]:pb-4 [&:not(:last-child)]:border-b border-netural-netural-300 [&:not(:last-child)]:border-opacity-30 break-all"},Pe=e("p",{class:"font-bold ch-heading-4"},"姓名：",-1),Le={class:"flex-1 ch-heading-4 break-all lg:text-right"},Ve={class:"flex flex-col justify-between items-start flex-wrap [&:not(:last-child)]:pb-4 [&:not(:last-child)]:border-b border-netural-netural-300 [&:not(:last-child)]:border-opacity-30 break-all"},Ee=e("p",{class:"font-bold ch-heading-4"},"收件地址：",-1),Me={class:"flex-1 ch-heading-4 break-all lg:text-right"},Be={class:"flex flex-col justify-between items-start flex-wrap [&:not(:last-child)]:pb-4 [&:not(:last-child)]:border-b border-netural-netural-300 [&:not(:last-child)]:border-opacity-30 break-all"},He=e("p",{class:"font-bold ch-heading-4"},"電話：",-1),Re={class:"flex-1 ch-heading-4 break-all lg:text-right"},Ae={class:"flex flex-col justify-between items-start flex-wrap [&:not(:last-child)]:pb-4 [&:not(:last-child)]:border-b border-netural-netural-300 [&:not(:last-child)]:border-opacity-30 break-all"},De=e("p",{class:"font-bold ch-heading-4"},"付款方式：",-1),Ne={class:"flex-1 ch-heading-4 break-all lg:text-right"},Ue={class:"flex flex-col justify-between items-start flex-wrap [&:not(:last-child)]:pb-4 [&:not(:last-child)]:border-b border-netural-netural-300 [&:not(:last-child)]:border-opacity-30 break-all"},Fe=e("p",{class:"font-bold ch-heading-4 break-all"},"金額：",-1),$e={class:"flex-shrink-0 pt-1 en-body text-secondary-secondary-200"},qe={class:"flex flex-col justify-between items-start flex-wrap [&:not(:last-child)]:pb-4 [&:not(:last-child)]:border-b border-netural-netural-300 [&:not(:last-child)]:border-opacity-30 break-all"},ze=e("p",{class:"font-bold ch-heading-4"},"付款狀態：",-1),Ge={key:0,class:"text-green-700"},Je={key:1,class:"text-red-800"},Ke={class:"flex flex-col justify-between items-start flex-wrap [&:not(:last-child)]:pb-4 [&:not(:last-child)]:border-b border-netural-netural-300 [&:not(:last-child)]:border-opacity-30 break-all"},Qe=e("p",{class:"font-bold ch-heading-4"},"留言：",-1),We={class:"flex-1 ch-heading-4 break-all lg:text-right"};function Xe(o,d,p,_,t,f){const k=i("PageHeader"),w=i("CartStep"),v=i("router-link");return r(),c(b,null,[u(k,{"image-url":t.pageImage},null,8,["image-url"]),e("div",B,[t.order.is_paid?a("",!0):(r(),O(w,{key:0,"current-step":o.currentStep},null,8,["current-step"])),e("div",H,[e("div",R,[e("div",A,[t.order.products?(r(!0),c(b,{key:0},I(t.order.products,(l,j)=>(r(),c("div",{class:"flex items-center p-4 bg-netural-netural-200",key:j},[e("div",D,[u(v,{to:`/product/${l.product.id}`,class:"flex items-center w-full",target:"_blank"},{default:P(()=>[e("div",N,[e("img",{class:"w-[140px] h-[90px] object-cover",src:l.product.imageUrl,alt:l.product.title},null,8,U)])]),_:2},1032,["to"])]),e("div",F,[e("div",$,[e("h3",q,s(l.product.title),1)]),e("div",z,[e("div",G," x "+s(l.qty),1),e("div",J,[e("div",K,[l.final_total!==l.total?(r(),c("div",Q," $"+s(o.$filters.currency(Math.round(l.total))),1)):a("",!0),e("div",W," $"+s(o.$filters.currency(Math.round(l.final_total))),1)])])])])]))),128)):a("",!0),e("div",X,[t.order.products&&Object.keys(t.order.products).length>0?(r(),c("div",Y,[Z,e("p",ee,s(Object.keys(t.order.products).length),1),te])):a("",!0)]),e("div",se,[e("div",oe,[e("div",le,[e("div",re,[ce,e("p",{class:x(["flex-shrink-0 en-caption-01",{"line-through":o.couponState.couponText!==""}])}," $"+s(o.$filters.currency(Math.round(t.finalTotal))),3)]),t.finalTotal!==t.order.total?(r(),c("div",ae,[ne,e("p",de," $"+s(o.$filters.currency(Math.round(t.order.total))),1)])):a("",!0),o.couponState.couponText!==""?(r(),c("div",ie,[he,e("p",pe,s(o.couponState.codeName),1)])):a("",!0)]),e("div",_e,[fe,e("p",ue," $"+s(o.$filters.currency(Math.round(t.order.total))),1)])])])])]),e("div",be,[e("div",xe,[e("div",ge,[ye,e("div",me,[ke,e("p",we,s(t.order.id),1)]),e("div",ve,[je,e("p",Se,s(o.$filters.date(t.order.create_at)),1)]),e("div",Ce,[Te,e("p",Oe,s(t.order.user.email),1)]),e("div",Ie,[Pe,e("p",Le,s(t.order.user.name),1)]),e("div",Ve,[Ee,e("p",Me,s(t.order.user.county)+s(t.order.user.district)+s(t.order.user.address),1)]),e("div",Be,[He,e("p",Re,s(t.order.user.tel),1)]),e("div",Ae,[De,e("p",Ne,s(t.order.user.paidMethod),1)]),e("div",Ue,[Fe,e("p",$e," $ "+s(o.$filters.currency(Math.round(t.order.total))),1)]),e("div",qe,[ze,e("p",{class:x(["flex-1 ch-heading-4 break-all lg:text-right",t.order.is_paid])},[t.order.is_paid?(r(),c("span",Ge,"付款完成")):(r(),c("span",Je,"尚未付款"))],2)]),e("div",Ke,[Qe,e("p",We,s(t.order.message),1)]),t.order.is_paid?a("",!0):(r(),c("button",{key:0,onClick:d[0]||(d[0]=(...l)=>f.payOrder&&f.payOrder(...l)),type:"button",class:"btn-base bg-secondary-secondary-200 text-netural-netural-100"}," 付款 "))])])])])])],64)}const lt=S(M,[["render",Xe]]);export{lt as default};
