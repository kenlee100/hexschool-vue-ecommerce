import{_ as k,a as S,m as $,r as h,o as a,c as n,e as d,b as e,F as u,g as _,i as l,t as c,n as I,k as m,v as V,w as y,u as N,f as j}from"./index-ad9fff6e.js";import{P}from"./PageHeader-a8cdfed0.js";import{C as T}from"./CartStep-3a9f610a.js";import{a as r}from"./common-d8506827.js";import{c as g}from"./cartStore-c8755473.js";import{t as v}from"./toast-befe74ea.js";const L="/hexschool-vue-ecommerce/assets/page_cart-3a9fcf63.jpg",{VITE_URL:E,VITE_PATH:M}={VITE_PATH:"ken100",VITE_URL:"https://vue3-course-api.hexschool.io/v2",BASE_URL:"/hexschool-vue-ecommerce",MODE:"production",DEV:!1,PROD:!0,SSR:!1},U={data(){return{isCouponCodeShow:!0,orderFinishInfo:{success:!0,message:"已建立訂單",total:0,orderId:"",create_at:Date.now(),email:""},pageImage:L}},components:{PageHeader:P,CartStep:T},methods:{...S(g,["getCartList","updateCart","deleteCartItem","clearCartItem","goNextStep","checkStep","couponPercent","loadCouponCode"]),async addCoupon(t){r().isProcessing=!0;try{await this.$http.post(`${E}/api/${M}/coupon`,{data:{code:this.couponState.codeName}}).then(o=>{this.isCouponCodeShow=!1,this.couponState.codeName=t,this.couponState.couponText=o.data.message,this.storeCouponCode(this.couponState),r().isProcessing=!1,v.fire({icon:"success",title:`${o.data.message}`}),this.getCartList()})}catch(o){r().isProcessing=!1,r().isLoading=!1,v.fire({icon:"error",title:`${o.response.data.message}`})}},storeCouponCode(t){localStorage.setItem("coupon",JSON.stringify(t))}},computed:{...$(g,["cart","currentStep","couponState"])},async mounted(){this.checkStep(1),r().isLoading=!0,await this.getCartList(),this.loadCouponCode()}},D={class:"container"},H={class:"flex flex-col lg:flex-row space-y-8 lg:space-y-0 lg:space-x-8"},R={class:"lg:w-[66.666%]"},A={class:"flex flex-col space-y-4"},B={class:"overflow-hidden hidden md:flex flex-shrink-0 w-[140px] [&:not(:last-child)]:mr-4"},F={class:"overflow-hidden"},O=["src","alt"],q={class:"flex flex-col md:flex-row md:items-center md:justify-between w-full space-y-4 md:space-y-0"},z={class:"w-full md:w-auto md:flex-1 md:pr-4"},J={class:"font-bold ch-heading-3 line-clamp-2"},Q={href:""},G={class:"flex flex-1 items-center md:justify-end md:flex-shrink-0"},K={class:"ch-body"},W=e("label",{for:"",class:"hidden"},"Qty:",-1),X={class:"form-select"},Y=["onUpdate:modelValue","onChange"],Z=e("option",{selected:"",disabled:""},"選擇數量",-1),ee=["value"],te={class:"flex items-center justify-end flex-shrink-0 min-w-[120px] ml-auto"},se={class:"flex flex-col items-end min-w-[50px] space-y-1"},oe={key:0,class:"en-caption-02 line-through text-right"},ae={class:"en-body text-right text-secondary-secondary-200"},ne=["onClick"],ce=e("span",{class:"material-symbols-outlined ch-heading-2"}," close ",-1),le=[ce],re={class:"flex items-center justify-between"},ie={key:0},de={key:1,class:"flex space-x-4 ch-heading-4 font-bold text-netural-netural-300"},ue=e("span",null,"共",-1),pe={class:"en-body text-secondary-secondary-200"},he=e("span",null,"件商品",-1),fe={class:"flex flex-col lg:w-[33.333%]"},_e={class:"sticky top-[72px] inset-x-0 space-y-8"},me={class:"flex flex-col p-4 md:p-6 space-y-4 bg-netural-netural-200"},ye=e("h2",{class:"font-bold ch-heading-2"},"購物車",-1),ge={class:"flex flex-col space-y-2 pb-3"},ve={class:"flex justify-between"},xe=e("p",{class:"font-bold ch-body"},"小計：",-1),be={key:0,class:"flex justify-between"},Ce=e("p",{class:"font-bold ch-body"},"折扣後：",-1),we={class:"flex-shrink-0 en-caption-01"},ke={class:"flex items-center space-x-2"},Se={class:"font-bold ch-body text-netural-netural-300"},$e={class:"flex justify-between"},Ie=e("p",{class:"font-bold ch-heading-4"},"總計:",-1),Ve={class:"flex-shrink-0 en-body text-secondary-secondary-200"},Ne={class:"p-4 md:p-6 bg-netural-netural-200"},je={class:"flex items-center"},Pe={class:"input-group"},Te={key:1,class:"flex flex-col justify-center space-y-4 max-w-[800px] mx-auto"},Le=e("p",{class:"ch-heading-3 text-center"}," 您的購物車目前有一點空虛，快來挑選一些商品吧！ ",-1),Ee={class:"py-4 text-center"};function Me(t,o,Ue,De,x,b){const C=h("PageHeader"),w=h("CartStep"),f=h("router-link");return a(),n(u,null,[d(C,{"image-url":x.pageImage},null,8,["image-url"]),e("div",D,[t.cart.carts&&t.cart.carts.length>=1?(a(),n(u,{key:0},[d(w,{"current-step":t.currentStep},null,8,["current-step"]),e("div",H,[e("div",R,[e("div",A,[t.cart.carts?(a(!0),n(u,{key:0},_(t.cart.carts,s=>(a(),n("div",{class:"flex items-center p-4 bg-netural-netural-200",key:s.id},[e("div",B,[d(f,{to:`/product/${s.product.id}`,class:"flex items-center w-full",target:"_blank"},{default:y(()=>[e("div",F,[e("img",{class:"w-[140px] h-[90px] object-cover",src:s.product.imageUrl,alt:s.product.title},null,8,O)])]),_:2},1032,["to"])]),e("div",q,[e("div",z,[e("h3",J,[e("a",Q,c(s.product.title),1)])]),e("div",G,[e("div",K,[W,e("div",X,[m(e("select",{name:"",id:"","onUpdate:modelValue":i=>s.qty=i,onChange:i=>t.updateCart(s)},[Z,(a(),n(u,null,_(30,(i,p)=>e("option",{key:p,value:p+1},c(p+1),9,ee)),64))],40,Y),[[N,s.qty,void 0,{number:!0}]])])]),e("div",te,[e("div",se,[s.final_total!==s.total?(a(),n("div",oe," $"+c(t.$filters.currency(Math.round(s.total))),1)):l("",!0),e("div",ae," $"+c(t.$filters.currency(Math.round(s.final_total))),1)])]),e("div",{class:"flex items-center justify-center w-10 h-10 ml-4 cursor-pointer",onClick:i=>t.deleteCartItem(s)},le,8,ne)])])]))),128)):l("",!0),e("div",re,[t.cart.carts&&t.cart.carts.length>0?(a(),n("div",ie,[e("button",{class:"btn-outline",type:"button",onClick:o[0]||(o[0]=(...s)=>t.clearCartItem&&t.clearCartItem(...s))}," 清空購物車 ")])):l("",!0),t.cart.carts&&t.cart.carts.length>0?(a(),n("div",de,[ue,e("p",pe,c(t.cart.carts.length),1),he])):l("",!0)])])]),e("div",fe,[e("div",_e,[e("div",me,[ye,e("div",ge,[e("div",ve,[xe,e("p",{class:I(["flex-shrink-0 en-caption-01",{"line-through":t.couponState.couponText!==""}])}," $"+c(t.$filters.currency(t.cart.total)),3)]),t.cart.final_total!==t.cart.total?(a(),n("div",be,[Ce,e("p",we," $"+c(t.$filters.currency(Math.round(t.cart.final_total))),1)])):l("",!0),e("div",ke,[e("p",Se,c(t.couponState.couponText),1)])]),e("div",$e,[Ie,e("p",Ve," $"+c(t.$filters.currency(Math.round(t.cart.final_total))),1)]),e("button",{type:"button",class:"btn-base w-full bg-secondary-secondary-200 text-netural-netural-100",onClick:o[1]||(o[1]=s=>t.goNextStep(2,"/order"))}," 前往結帳 ")]),e("div",Ne,[e("div",je,[e("div",Pe,[m(e("input",{type:"text",class:"form-input",placeholder:"輸入優惠券代碼","onUpdate:modelValue":o[2]||(o[2]=s=>t.couponState.codeName=s)},null,512),[[V,t.couponState.codeName]]),e("button",{type:"button",class:"flex-shrink-0 p-4 whitespace-nowrap bg-netural-netural-400 text-netural-netural-100",onClick:o[3]||(o[3]=s=>b.addCoupon(t.couponState.codeName))}," 套用 ")])])])])])])],64)):(a(),n("div",Te,[Le,e("div",Ee,[d(f,{class:"btn-base text-netural-netural-100 bg-secondary-secondary-100",to:"/products"},{default:y(()=>[j("瀏覽推薦行程")]),_:1})])]))])],64)}const qe=k(U,[["render",Me]]);export{qe as default};
