import{_ as w,a as v,m as j,r as h,o as r,c,e as _,b as e,h as O,i as d,F as f,g as C,t as s,n as b,w as I}from"./index-a352aac4.js";import{P as S}from"./PageHeader-ffb7cc6f.js";import{C as M,g as P,p as B}from"./order-ebf801a2.js";import{a as i}from"./common-10f7587a.js";import{c as x}from"./cartStore-794f6400.js";import{t as L}from"./request-a94ccf31.js";const T="/hexschool-vue-ecommerce/assets/page_checkout-59354980.jpg",V={data(){return{order:{products:[],user:{}},finalTotal:{},pageImage:T,orderId:""}},components:{PageHeader:S,CartStep:M},methods:{...v(x,["checkStep","couponPercent"]),async getOrder(o){const n=await P(o);i().isLoading=!1;const{order:p}=n;this.order=p,this.finalTotal=Object.entries(this.order.products).reduce((u,t)=>u+t[1].total,0)},async payOrder(o){i().isProcessing=!0,await B(o),await this.getOrder(o),await L.fire({icon:"success",title:"付款完成"}),i().isProcessing=!1}},computed:{...j(x,["currentStep","cartCoupon"]),productsId(){return Object.keys(this.order.products)[0]},couponIsShow(){return this.order.products[this.productsId]&&Object.keys(this.order.products[this.productsId]).includes("coupon")},orderCoupon(){if(Object.keys(this.order).length){const o=Object.keys(this.order.products)[0],n=this.order.products[o];if(o&&Object.keys(n).includes("coupon")&&n.coupon.code!=="coupon_clear")return n.coupon}return{}}},created(){i().isLoading=!0,this.checkStep(3),this.orderId=this.$route.params.orderId,this.getOrder(this.orderId)}},H={class:"container"},N={class:"flex flex-col lg:flex-row space-y-8 lg:space-y-0 lg:space-x-8"},F={class:"lg:w-[66.666%]"},q={class:"flex flex-col space-y-4"},z={class:"overflow-hidden hidden md:flex flex-shrink-0 w-[140px] [&:not(:last-child)]:mr-4"},A={class:"overflow-hidden"},D=["src","alt"],E={class:"flex flex-col md:flex-row md:items-center md:justify-between w-full space-y-4 md:space-y-0"},U={class:"w-full md:w-auto md:flex-1 md:pr-4"},G={class:"font-bold ch-heading-3 line-clamp-2"},J={class:"flex flex-1 items-center md:justify-end md:flex-shrink-0"},K={class:"ml-auto en-caption-01 whitespace-nowrap"},Q={class:"flex items-center justify-end flex-shrink-0 min-w-[120px]"},R={class:"flex flex-col items-end min-w-[50px] space-y-1"},W={key:0,class:"en-caption-02 line-through text-right"},X={class:"en-body text-right text-secondary-secondary-200"},Y={class:"flex items-center justify-end"},Z={key:0,class:"flex space-x-4 ch-heading-4 font-bold text-netural-netural-300"},$=e("span",null,"共",-1),ee={class:"en-body text-secondary-secondary-200"},te=e("span",null,"件商品",-1),se={class:"space-y-8"},oe={class:"flex flex-col p-4 md:p-6 space-y-4 bg-netural-netural-200"},re={class:"flex flex-col space-y-2 pb-3"},le={class:"flex justify-between"},ce=e("p",{class:"font-bold ch-body"},"小計：",-1),ne={key:0,class:"flex justify-between"},de=e("p",{class:"font-bold ch-body"},"折扣後：",-1),ae={class:"flex-shrink-0 en-caption-01"},ie={key:1,class:"flex justify-between"},he=e("p",{class:"font-bold ch-body"},"優惠券：",-1),pe={class:"font-bold ch-body text-netural-netural-300"},ue={class:"flex justify-between"},_e=e("p",{class:"font-bold ch-heading-4"},"總計:",-1),fe={class:"flex-shrink-0 en-body text-secondary-secondary-200"},be={class:"flex flex-col lg:w-[33.333%]"},xe={class:"overflow-hidden flex flex-col items-center p-4 md:p-6 bg-netural-netural-200"},ye={class:"flex flex-col w-full space-y-4"},ge=e("h3",{class:"ch-heading-2 font-bold"},"訂單明細",-1),me={class:"flex flex-col justify-between items-start flex-wrap [&:not(:last-child)]:pb-4 [&:not(:last-child)]:border-b border-netural-netural-300 [&:not(:last-child)]:border-opacity-30 break-all"},ke=e("p",{class:"font-bold ch-heading-4"},"訂單編號：",-1),we={class:"flex-1 ch-heading-4 break-all lg:text-right"},ve={class:"flex flex-col justify-between items-start flex-wrap [&:not(:last-child)]:pb-4 [&:not(:last-child)]:border-b border-netural-netural-300"},je=e("p",{class:"font-bold ch-heading-4"},"訂單建立時間：",-1),Oe={class:"flex-1 ch-heading-4 break-all lg:text-right"},Ce={class:"flex flex-col justify-between items-start flex-wrap [&:not(:last-child)]:pb-4 [&:not(:last-child)]:border-b border-netural-netural-300 [&:not(:last-child)]:border-opacity-30 break-all"},Ie=e("p",{class:"font-bold ch-heading-4"},"信箱：",-1),Se={class:"flex-1 ch-heading-4 break-all lg:text-right"},Me={class:"flex flex-col justify-between items-start flex-wrap [&:not(:last-child)]:pb-4 [&:not(:last-child)]:border-b border-netural-netural-300 [&:not(:last-child)]:border-opacity-30 break-all"},Pe=e("p",{class:"font-bold ch-heading-4"},"姓名：",-1),Be={class:"flex-1 ch-heading-4 break-all lg:text-right"},Le={class:"flex flex-col justify-between items-start flex-wrap [&:not(:last-child)]:pb-4 [&:not(:last-child)]:border-b border-netural-netural-300 [&:not(:last-child)]:border-opacity-30 break-all"},Te=e("p",{class:"font-bold ch-heading-4"},"收件地址：",-1),Ve={class:"flex-1 ch-heading-4 break-all lg:text-right"},He={class:"flex flex-col justify-between items-start flex-wrap [&:not(:last-child)]:pb-4 [&:not(:last-child)]:border-b border-netural-netural-300 [&:not(:last-child)]:border-opacity-30 break-all"},Ne=e("p",{class:"font-bold ch-heading-4"},"電話：",-1),Fe={class:"flex-1 ch-heading-4 break-all lg:text-right"},qe={class:"flex flex-col justify-between items-start flex-wrap [&:not(:last-child)]:pb-4 [&:not(:last-child)]:border-b border-netural-netural-300 [&:not(:last-child)]:border-opacity-30 break-all"},ze=e("p",{class:"font-bold ch-heading-4"},"付款方式：",-1),Ae={class:"flex-1 ch-heading-4 break-all lg:text-right"},De={class:"flex flex-col justify-between items-start flex-wrap [&:not(:last-child)]:pb-4 [&:not(:last-child)]:border-b border-netural-netural-300 [&:not(:last-child)]:border-opacity-30 break-all"},Ee=e("p",{class:"font-bold ch-heading-4 break-all"},"金額：",-1),Ue={class:"flex-shrink-0 pt-1 en-body text-secondary-secondary-200"},Ge={class:"flex flex-col justify-between items-start flex-wrap [&:not(:last-child)]:pb-4 [&:not(:last-child)]:border-b border-netural-netural-300 [&:not(:last-child)]:border-opacity-30 break-all"},Je=e("p",{class:"font-bold ch-heading-4"},"付款狀態：",-1),Ke={key:0,class:"text-green-700"},Qe={key:1,class:"text-red-800"},Re={class:"flex flex-col justify-between items-start flex-wrap [&:not(:last-child)]:pb-4 [&:not(:last-child)]:border-b border-netural-netural-300 [&:not(:last-child)]:border-opacity-30 break-all"},We=e("p",{class:"font-bold ch-heading-4"},"留言：",-1),Xe={class:"flex-1 ch-heading-4 break-all lg:text-right"};function Ye(o,n,p,u,t,a){const y=h("PageHeader"),g=h("CartStep"),m=h("router-link");return r(),c(f,null,[_(y,{"image-url":t.pageImage},null,8,["image-url"]),e("div",H,[t.order.is_paid?d("",!0):(r(),O(g,{key:0,"current-step":o.currentStep},null,8,["current-step"])),e("div",N,[e("div",F,[e("div",q,[t.order.products?(r(!0),c(f,{key:0},C(t.order.products,(l,k)=>(r(),c("div",{class:"flex items-center p-4 bg-netural-netural-200",key:k},[e("div",z,[_(m,{to:`/product/${l.product.id}`,class:"flex items-center w-full",target:"_blank"},{default:I(()=>[e("div",A,[e("img",{class:"w-[140px] h-[90px] object-cover",src:l.product.imageUrl,alt:l.product.title},null,8,D)])]),_:2},1032,["to"])]),e("div",E,[e("div",U,[e("h3",G,s(l.product.title),1)]),e("div",J,[e("div",K," x "+s(l.qty),1),e("div",Q,[e("div",R,[l.final_total!==l.total?(r(),c("div",W," $"+s(o.$filters.currency(Math.round(l.total))),1)):d("",!0),e("div",X," $"+s(o.$filters.currency(Math.round(l.final_total))),1)])])])])]))),128)):d("",!0),e("div",Y,[t.order.products&&Object.keys(t.order.products).length>0?(r(),c("div",Z,[$,e("p",ee,s(Object.keys(t.order.products).length),1),te])):d("",!0)]),e("div",se,[e("div",oe,[e("div",re,[e("div",le,[ce,e("p",{class:b(["flex-shrink-0 en-caption-01",{"line-through":a.couponIsShow}])}," $"+s(o.$filters.currency(Math.round(t.finalTotal))),3)]),t.finalTotal!==t.order.total?(r(),c("div",ne,[de,e("p",ae," $"+s(o.$filters.currency(Math.round(t.order.total))),1)])):d("",!0),Object.keys(a.orderCoupon).length?(r(),c("div",ie,[he,e("p",pe,s(a.orderCoupon.code),1)])):d("",!0)]),e("div",ue,[_e,e("p",fe," $"+s(o.$filters.currency(Math.round(t.order.total))),1)])])])])]),e("div",be,[e("div",xe,[e("div",ye,[ge,e("div",me,[ke,e("p",we,s(t.order.id),1)]),e("div",ve,[je,e("p",Oe,s(o.$filters.date(t.order.create_at)),1)]),e("div",Ce,[Ie,e("p",Se,s(t.order.user.email),1)]),e("div",Me,[Pe,e("p",Be,s(t.order.user.name),1)]),e("div",Le,[Te,e("p",Ve,s(t.order.user.county)+s(t.order.user.district)+s(t.order.user.address),1)]),e("div",He,[Ne,e("p",Fe,s(t.order.user.tel),1)]),e("div",qe,[ze,e("p",Ae,s(t.order.user.paidMethod),1)]),e("div",De,[Ee,e("p",Ue," $ "+s(o.$filters.currency(Math.round(t.order.total))),1)]),e("div",Ge,[Je,e("p",{class:b(["flex-1 ch-heading-4 break-all lg:text-right",t.order.is_paid])},[t.order.is_paid?(r(),c("span",Ke,"付款完成")):(r(),c("span",Qe,"尚未付款"))],2)]),e("div",Re,[We,e("p",Xe,s(t.order.message),1)]),t.order.is_paid?d("",!0):(r(),c("button",{key:0,onClick:n[0]||(n[0]=l=>a.payOrder(this.orderId)),type:"button",class:"btn-base bg-secondary-secondary-200 text-netural-netural-100"}," 付款 "))])])])])])],64)}const rt=w(V,[["render",Ye]]);export{rt as default};
