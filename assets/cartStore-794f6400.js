import{d as u,I as n}from"./index-a352aac4.js";import{a as r}from"./common-10f7587a.js";import{s as a,t as i,S as l}from"./request-a94ccf31.js";const s=t=>({get(){return localStorage.getItem(t)},set(e){return localStorage.setItem(t,e)},remove(){return localStorage.removeItem(t)}}),C=t=>a({url:"/cart",method:"POST",data:t}),p=()=>a({url:"/cart",method:"GET"}),g=(t,e)=>a({url:`/cart/${t.id}`,method:"PUT",data:e}),S=t=>a({url:`/cart/${t.id}`,method:"DELETE"}),d=()=>a({url:"/carts",method:"DELETE"}),w=u("cartStore",{state:()=>({cart:{},currentStep:1}),actions:{async getCartList(){const{data:t}=await p();this.cart=t},async updateCart(t){r().isProcessing=!0,await g(t,{data:{product_id:t.product_id,qty:t.qty}}),await this.getCartList();const{product:{title:e}}=t;r().isProcessing=!1,await i.fire({icon:"success",title:`已更新 品名：${e} 數量`})},async deleteCartItem(t){r().isProcessing=!0;const e=await S(t);await this.getCartList(),r().isProcessing=!1;const{product:{title:c}}=t,{message:o}=e;await i.fire({icon:"success",title:`${c} ${o}`})},async clearCartItem(){l.mixin({customClass:{confirmButton:"!btn !btn-base !text-netural-netural-100 !bg-secondary-secondary-200",cancelButton:"!btn-outline"},buttonsStyling:!1}).fire({title:"確定清除購物車嗎？",showCancelButton:!0,cancelButtonText:"取消",confirmButtonText:"確定"}).then(async e=>{e.isConfirmed&&(r().isProcessing=!0,await d().then(async c=>{const{message:o}=c;await this.getCartList(),r().isProcessing=!1,this.removeCoupon(),await i.fire({icon:"success",title:`${o} 購物車`})}))})},goBackStep(t,e){this.currentStep=+s("currentStep").get(),t<this.currentStep&&(s("currentStep").set(JSON.stringify(t)),n.push(e))},goNextStep(t,e){this.currentStep=+s("currentStep").get(),t>this.currentStep&&(s("currentStep").set(JSON.stringify(t)),n.push(e))},checkStep(t){this.currentStep=t,s("currentStep").set(JSON.stringify(this.currentStep))},couponPercent(t){return`-${100-t.final_total/t.total*100}%`}},getters:{cartCoupon(){const t=this.cart.carts.length&&this.cart.carts[0];return t&&t.coupon&&t.coupon.code!=="coupon_clear"?t.coupon:{}}}});export{C as a,w as c};
